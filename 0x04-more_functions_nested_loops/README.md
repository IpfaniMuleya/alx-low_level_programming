Deeper dive into more functions, and more nested loops
